---
layout: post
title: "ARIMA(1)"
tags: [Time Series]
use_math: true
comments: true
---

### Stationarity
**Time series(시계열)**, 혹은 stochastic process는 index set $\mathbf{T}$와 sample space $\Omega$에 대해 정의된 확률변수열
$$
X(t, \omega) = X_t(\omega)
$$
를 의미하며, 우리는 일반적으로 고정된 $\bar{\omega} \in \Omega$에 대한 시계열 $x_t = X_t(\bar{\omega})$를 관찰합니다. 우리는 시계열분석을 할 때, 시계열자료의 값을 결정하는 규칙이 존재하며 그 규칙이 시간에 따라 변하지 않는다고 가정합니다. 이러한 time invariance property에는 대표적으로 **stationarity(정상성)**이 있습니다. 

먼저 **strong stationarity**는 시계열의 분포함수 $F$와 양의 시차 $h > 0$에 대하여 
$$F_{X_{t_1}, \cdots, X_{t_n}}(x_{t_1}, \cdots, x_{t_n}) = F_{X_{t_1 + h}, \cdots, X_{t_n + h}}(x_{t_1}, \cdots, x_{t_n})$$
이 만족하는 성질을 일컫습니다. 이는 곧 시작 시점이 언제인지에 상관없이 특정한 간격을 둔 $X_t$들 사이의 분포가 완벽히 동일함을 의미합니다. 한편 이는 매우 강한 가정이기 때문에, 이를 약화하여 이차 이하의 적률이 시간에 무관하게 동일하다는 제약조건
- $\text{E}[X_t] = \mu, \; \forall t$
- $\text{Cov}(X_t, X_{t-s}) = \gamma_s < \infty, \; \forall t$

을 만족하는 시계열을 **weak stationarity**를 만족한다고 말합니다. 혹은 그러한 시계열을 **(약)정상시계열**이라 부르기도 합니다. 이름만 보아서는 강정상시계열이면 항상 약정상시계열이어야 할 것만 같지만, 이는 아닙니다. IID 확률변수로 이루어진 확률변수열은 강정상시계열임이 당연합니다. 시차에 어떠한 영향도 받지 않기 때문입니다. 그렇지만 해당 확률변수가 코시분포처럼 $\text{E}[X_1^2] = \infty$인 분포라면, 약정상시계열은 될 수 없습니다. 당연히 약정상시계열이라 해서 강정상시계열인 것도 아닙니다. 각 $X_t$의 평균과 분산은 같지만 그 분포함수는 다르고, $X_t$와 $X_{t-s}$는 독립적으로 결정되는 시계열을 생각해보면 간단합니다.


### White Noise
**White noise(백색잡음)**은 시계열 자료에서 추세나 정보를 담고 있지 않고 무작위적인 변동에 의하여 형성되는 확률변수열 $\text{WN}_t$를 일컫습니다. $\text{WN}_t$는 아래 조건을 만족해야 합니다. 

- $\text{E}[\text{WN}_t] = 0$
- $\text{Cov}(\text{WN}_t, \text{WN}_{t-s}) = \begin{cases} \sigma^2 & \text{if} \; s = 0\\ 0 & \text{otherwise} \end{cases}$

이는 앞에서 확인한 weak stationaity 조건을 만족($\mu = 0, \gamma_0 = \sigma^2, \gamma_s = 0, \; \forall s \neq 0$)하므로, 정상시계열입니다. 한편 계량경제학 등의 분야에서는 이러한 $\epsilon_t$를 **innovation**이라 부르기도 합니다. 앞으로 우리는 편의상 innovation의 분포를 $\text{WN}(0, \sigma^2)$과 같이 쓰도록 하겠습니다.

### MA Process
시계열 분석 과정에서 자주 등장하는 **moving average(이동평균; MA)** 모형 역시 정상시계열의 일종입니다. MA process를 따르는 시계열은 과거의 innovation들의 가중평균으로 나타낼 수 있습니다. 일반적으로, 시차 $q$인 MA process $\text{MA}(q)$는 
$$
X_t = \epsilon_t + \psi_1 \epsilon_{t-1} + \psi_2 \epsilon_{t-2} + \cdots + \psi_q \epsilon_{t-q}, \quad \epsilon_t \sim \text{WN}(0, \sigma_{\epsilon}^2)
$$
에 의해 결정됩니다. 만약 $\psi_0 = 1$이라 둘 경우 간단하게 
$$
X_t = \sum_{j=0}^{q} \psi_j \epsilon_{t-j}
$$
처럼 쓸 수도 있습니다. 이때 평균과 공분산을 구한다면
$$
\text{E}[X_t] = \text{E}\left[\sum_{j=0}^{q} \psi_j \epsilon_{t-j}\right] = \sum_{j=0}^{q} \psi_j \text{E}[\epsilon_{t-j}] = 0
$$
이며 
$$
\text{Var}(X_t) = \text{Var}\left(\sum_{j=0}^{q} \psi_j \epsilon_{t-j}\right) = \sum_{j = 0}^{q} \psi_j^2 \text{Var}(\epsilon_{t-j}) = \sigma_{\epsilon}^2 \cdot  \sum_{j = 0}^{q} \psi_j^2
$$

$$\begin{aligned} \text{Cov}(X_t, X_{t-s}) &= \text{Cov}\left(\sum_{j=0}^{q} \psi_j \epsilon_{t-j}, \sum_{k=0}^{q} \psi_k \epsilon_{t-s-k}\right)\\\\\\
&= \sum_{j=0}^{q} \sum_{k=0}^{q} \psi_j \psi_k \text{Cov}(\epsilon_{t-j},\epsilon_{t-s-k})\\\\\\
&= \sigma_{\epsilon}^2 \cdot \sum_{j=s}^{q} \psi_j \psi_{j-s} 
\end{aligned}$$
을 얻습니다. 이때 이들이 모두 $t$에 무관한 것을 볼 수 있기 때문에, 정상시계열의 조건을 만족합니다. 

한편 유한한 $q$가 아니라, 이를 무한히 확장하여 $\text{MA}(\infty)$ process를 생각해볼 수도 있습니다. 이 경우 
$$
X_t = \epsilon_t + \psi_1 \epsilon_{t-1} + \cdots = \sum_{j=0}^{\infty} \psi_j \epsilon_{t-j}, \quad \epsilon_t \sim \text{WN}(0, \sigma_{\epsilon}^2)
$$
입니다. 하지만 이 시계열이 항상 정상시계열인 것만은 아닙니다. 이 시계열이 정상시계열일 조건은 $\text{Var}(X_t) < \infty$, 즉 square summability
$$
\sum_{j=0}^{\infty} \psi_j^2 < \infty
$$
으로 주어집니다. 


### AR Process

**Autoregressive(자기회귀; AR)** 모형 역시 간단한 조건을 만족할 경우 정상시계열임이 알려져 있습니다. 시차가 $p$인 $\text{AR}(p)$ 모형은
$$
X_t = \phi_1 X_{t-1} + \phi_2 X_{t-2} + \cdots + \phi_p X_{t-p} + \epsilon_t, \quad \epsilon_t \sim \text{WN}(0, \sigma_{\epsilon}^2)
$$
으로 주어집니다. 그 이름은 $X_t$가 자기 자신의 이전 시기 자료인 $X_{t-1}, \cdots, X_{t-p}$에 의한 회귀식의 형태로 표현될 수 있다는 점으로부터 비롯합니다. 한편 AR 모형은 MA 모형과 달리 일반적인 $p$에 대하여 그 평균, 분산, 공분산을 손으로 간단히 계산하기 어렵습니다. 우리는 그 계산과 정상성 판단을 위하여, 아래의 개념을 먼저 확인하여 보겠습니다.

- **back shift operator(후행연산자)**, 혹은 lag operator $L$은 시계열에서 아래의 작용을 수행하는 연산자를 말합니다.
    $$
    (L)X_t = X_{t-1}
    $$
    만약 이 연산자를 하나의 변수로 취급하면, 다항식 $a(L) = \sum_{j=0}^{\infty} a_i L^j$를 고려할 수 있고, 이 연산자는
    $$
    (a(L))X_t = \left(\sum_{j=0}^{\infty} a_i L^j\right)X_t  = \sum_{j=0}^{\infty} a_i X_{t-j}
    $$
    처럼 선형적으로 작용합니다. 이를 통해 AR 모형은 
    $$
    (1 - \phi_1 L - \phi_2 L^2 - \cdots - \phi_p L^p)X_t = \epsilon_t
    $$
    으로 표현됩니다.

- $\text{AR}(p)$ 모형의 **characteristic function(특성함수)**는 복소평면에서의 함수 $\phi:\mathbb{C} \rightarrow \mathbb{C}$, 
    $$
    \phi(z) := 1- \phi_1 z - \phi_2 z^2 - \cdots - \phi_p z^p
    $$
    을 의미합니다. 그리고 $\phi(z) = 0$를 **characteristic equation(특성함수)**라고 부릅니다. 한편, $z$ 자리에 $L$을 넣으면 
    $$
    \phi(L)X_t = \epsilon_t
    $$
    처럼 AR 모형의 표현이 가능해짐을 알 수 있습니다.

만약 characteristic equation의 근들이 모두 unit circle의 밖에 있다면, 즉 $\phi(z)  = 0$을 만족하는 모든 $z \in \mathbb{C}$가 $|z| > 1$을 만족한다면, 이 $\text{AR}(p)$를 따르는 시계열은 정상시계열임이 알려져 있습니다. 이는 각 충격에 의한 반응이 시간의 흐름에 따라 지수적으로 감소하여 결국에는 사라지게 됨을 의미합니다. 







# References
김재영 교수님 강의노트(시계열분석특수연구)

이상열. (2023). 시계열 분석: 이론 및 SAS 실습. 2판. 자유아카데미.